sudo: required
dist: trusty
before_install:
    - sudo apt-get -qq update && sudo apt-get install -y --no-install-recommends texlive-fonts-recommended texlive-latex-extra texlive-fonts-extra dvipng texlive-latex-recommended latexmk texlive-lang-german texlive-doc-de pgf texlive-font-utils zip inkscape texlive-math-extra graphviz make git openssh-client figlet
      
addons:
  ssh_known_hosts: aul12.me
  sonarcloud:
    organization: "sopra-team-10" # the key of the org you chose at step #3
    token:
      secure: $SONAR_TOKEN # encrypted value of your token

script:
    - sonar-scanner
    - mkdir output
    - cd Meilenstein01
    - make
    - mv main.pdf ../output/Blatt01.pdf
    - cd ..

notifications:
    slack: $SLACK_TOKEN
    
before-deploy:
    - mkdir -p ~/.ssh
    - eval "$(ssh-agent -s)"
    - echo "$DEPLOY_KEY" | xxd -r -p > ~/.ssh/deployKey
    - chmod 0666 ~/.ssh/deployKey
    - ssh-add ~/.ssh/deployKey

deploy:
    provider: script 
    skip-cleanup: true
    keep-history: true
    local-dir: output
    script: scp -i ~/.ssh/deployKey *.pdf paul@aul12.me:/var/www/html/Sopra
    on:
        branch: master
    #   provider: pages
    #skip-cleanup: true
    #github-token: $GITHUB_TOKEN  # Set in travis-ci.org dashboard, marked secure
    #keep-history: true
    #local-dir: output
    #on:
    #    branch: master
        #provider: script
        #script: sh deployGitlab.sh $TRAVIS_COMMIT
        # on:
        #branch: master
